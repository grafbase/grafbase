$schema: 'https://moonrepo.dev/schemas/tasks.json'

fileGroups:
  cargo:
    - '/cli/Cargo.*'

  sources:
    - 'src/**/*'
    - 'Cargo.toml'

  tests:
    - 'tests/**/*'

  assets:
    - 'assets/**/*'

tasks:
  build:
    command: 'cargo build'
    inputs:
      - '@globs(cargo)'
      - '@globs(sources)'
    outputs:
      - '/cli/target'

  test:
    command: 'cargo nextest run --profile ci'
    inputs:
      - '@globs(cargo)'
      - '@globs(tests)'

  fmt:
    command: 'cargo fmt --check'
    inputs:
      - '@globs(sources)'

  clippy:
    command: 'cargo clippy --locked --all-targets --tests -- -D warnings'
    inputs:
      - '@globs(sources)'

  check:
    command: 'cargo check'
    inputs:
      - '@globs(cargo)'
      - '@globs(sources)'

